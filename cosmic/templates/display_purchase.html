{% extends 'cosmic_base.html' %}

{% block content %}

  <div style="margin-left: 200px;">
    <strong>
        <h2>Purchase Details</h2>
      </strong>
  </div>
  <!-- <form action="/GRN/print_pr">
    <div class="form-group col-sm-4" style="display: flex; margin-top: 20px; ">
      <input type="text" name="PR_no" placeholder="PR No" class="form-control" style=" margin-top: 10px; ">
      <div style="width: 20%;"><button type="submit" class="btn btn-primary">Search Order</button></div>
    </div>
  </form> -->
 
  <br>
  <br>

  
<div class="container">
         
    <table class="table table-striped table-bordered" style="margin-top: 20px;" id="example">
      <thead>
                    <tr >
                      <th style="text-align: left;">Purchase Number</th>
                      <th style="text-align: left;">PFI No.</th>
                      <th>Date</th>
                      <th>Items </th>
                      <th style="text-align: left;">Quantity</th>
                      <th>Unit Price</th>
                      <th>Total Price</th>
                      <th>Supplier Name</th>
                      <th>Status</th>
                      <!-- <th>Action</th> -->
                    </tr>
                  </thead>

                  <tbody>
                    {% for purchase in my_purchase %}
                    <tr>
                      <td style="text-align: left;"><a href="/cosmic/display_single_purchase/{{purchase.purchase_no}}">{{ purchase.purchase_no }}</a></td>
                      <td style="text-align: left;">{{ purchase.ref_no }}</td>
                      <td>{{ purchase.date }}</td>
                      <td>
                        {% for item in purchase.order_items.all %}
                            {{ item.item_name }}
                            {% if not forloop.last %}<br>{% endif %}
                        {% endfor %}
                    </td>
                    <td style="text-align: left;">{% for item in purchase.order_items.all %}
                      {{ item.quantity }}
                      {% if not forloop.last %}<br>{% endif %}
                  {% endfor %}</td>
                    <td>
                      {% for item in purchase.order_items.all %}
                          {{ item.price }}
                          {% if not forloop.last %}<br>{% endif %}
                      {% endfor %}
                  </td>
                      <td>{% for item in purchase.order_items.all %}
                        {{ item.before_vat }}
                        {% if not forloop.last %}<br>{% endif %}
                    {% endfor %}</td>
                      
                      <td>{{ purchase.supplier_name.supplier_name }}</td>
                      <td>{{ purchase.status }}</td>
                      <!-- <td><button onclick="redirectToPrintOrder('{{ my_order.purchase_no }}')" type="submit">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 20px; width:20px; float:left;" ><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zM432 248a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></a>
                        </td> -->
                      <!-- </button> -->
                    </tr>
                    {% endfor %}
                  </tbody>   
                  </table>
  </div>
        
  

  
</div>

<!-- <script>

// const PurchaseID = document.getElementById('data-order-id');
const PurchaseID = purchase.purchasee_no
function redirectToPrintOrder(PurchaseID) {
      
window.location.href = `/cosmic/display_single_purchase/PurchaseID`;

//window.location.href = `/cosmic/print_order?order_no=${orderID}&invoice_num=${invoiceID}`;  
}
</script> -->

<!-- <script>
  document.addEventListener('DOMContentLoaded', function () {
      const orderLinks = document.querySelectorAll('.order-link');
      console.log("p2")
      orderLinks.forEach(function (link) {
          link.addEventListener('click', function (event) {
              event.preventDefault();
              console.log("p2")
              const purchaseID = this.getAttribute('data-order-id');
              window.location.href = `/cosmic/display_single_purchase?purchase_no=${purchaseID}`;
          });
      });
      const orderLinks2 = document.querySelectorAll('.order-link2');
      console.log("p2")
      orderLinks2.forEach(function (link) {
          link.addEventListener('click', function (event) {
              event.preventDefault();
              console.log("p2")
              const purchaseID = this.getAttribute('data-order-id');
              window.location.href = `/GRN/display_single_pruchase?PR_no=${purchaseID}`;
          });
      });
  });
</script> -->
{% endblock %}

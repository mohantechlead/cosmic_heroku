{% extends 'cosmic_base.html' %}
{% load humanize %}
{% block content %}
<div class="form-group {% if my_order.status == 'Pending' %} pending block-print {% else %} default {% endif %}" style="margin-top: 0;margin-left: 0;background-position-x: center;background-position-y: center;background-repeat: no-repeat;">
    <div style="display: flex;">
        
            <div class="text-muted">
                <img src="../static/logo.jpg" alt="" style="width: 150px; border-radius: 50%; margin-left: 380px;">
                <h3 style="margin-left: 300px;">Cosmic Connection FZE</h3>
                <p style="margin-left: 350px; text-align: center;">Free Zone, Djibouti
                    <br>Email: tanirm@gmail.com <br>TEL.+253-77 81 55 70
                </p>

                {% if my_order.order_no %}
                <h4 style="margin-left: 340px; margin-top: 50px; font-size: 24px;">Proforma Invoice</h4>
                {%else%}
                <h4 style="margin-left: 62%; margin-top: 20px; font-size: 24px;">Purchase Order</h4>
                {%endif%} </div>
            
    
        
    </div>
    <div class="table-responsive " style="text-align: center;">
        <table class="table table-nowrap mb-0" style="margin-bottom: 0;margin-left: 0;">
            <thead>
              
                <tr>
                    <th style="width: 400px;">
                        <h4 class="text-muted text-sm-end font-size-15 mb-1">Seller Details</h4>
                        <div class="text-muted">
                            <p class="mb-1" style="line-height: 1.2;font-size: small;">{{my_order.supplier_name.supplier_name}} <br>
                                {{my_order.supplier_name.supplier_address}}</p>

                        </div>
                    </th>
                    <th>
                        <div class="col-sm-5" style="width: 140px;padding: 0;">
                            <div class="text-muted text-sm-end">
                                {% if my_order.order_no %}
                                <div class="mt-4">
                                    <h5 class="font-size-15 mb-1" style="margin: 0;">Order No:</h5>
                                    <p style="margin: 0;font-size: small;">{{my_order.order_no}}</p>
                                </div>
                                {%else%}
                                <div class="mt-4">
                                    <h5 class="font-size-15 mb-1" style="margin: 0;">Purchase No:</h5>
                                    <p style="margin: 0;font-size: small;">{{my_order.purchase_no}}</p>
                                </div>
                                {%endif%}
                                <div class="mt-4">
                                    <h5 class="font-size-15 mb-1" style="margin: 0;">Invoice Date:</h5>
                                    <p style="margin: 0;font-size: small;">{{my_order.date}}</p>
                                </div>


                            </div>
                        </div>
                    </th>
                    <th>
                        <div class="text-muted text-sm-end" style="width: 200px;padding: 0;">
                            
                            <div class="mt-4">
                                {% if my_order.order_no %}
                                <h5 class="font-size-15 mb-1" style="margin: 0;">Proforma Invoice No:</h5>
                                {%else%}
                                <h5 class="font-size-15 mb-1" style="margin: 0;">PFI No:</h5>
                                {%endif%}
                                <p style="margin: 0;font-size: small;"> {{my_order.ref_no}}</p>
                                {% if my_order.freight%}
                        <div class="text-muted">
                            <h5 class="font-size-15 mb-1" style="line-height: 0.7;">Freight</h5>
                            <p class="mb-1" style="line-height: 1.2;font-size: small;">{{my_order.freight}}</p>

                        </div>
                        {% endif%}
                            </div>
                            
                            {%if shipping.customer_no%}
                            <div class="text-muted">
                                <h5 class="font-size-15 mb-1">Customer Ref. no</h5>
                                <p class="mb-1" style="font-size: small;">{{shipping.customer_no}}</p>


</div>
                            {%endif%}
                        </div>
                    </th>
                </tr>
            </thead><!-- end thead -->
            <tbody>
                <tr>
                    
                    <th>
                        <h4 class="text-muted text-sm-end font-size-13 mb-1">Buyer Details</h4>
                        <div class="text-muted font-size: small;">
                            <p class="mb-1 font-size-11" style="line-height: 1.2; font-size: small;">{{my_order.customer_name.customer_name}} <br>
                                {{my_order.customer_name.customer_address}}</p>

                        </div>
                        {% if my_order.notify_party%}
                    
                    
                        <h4 class="text-muted text-sm-end font-size-13 mb-1">Notify Party</h4>
                        <div class="text-muted font-size: small;">
                            <p class="mb-1 font-size-11" style="line-height: 1.2; font-size: small;">{{my_order.notify_party.customer_name}} <br>
                                {{my_order.notify_party.customer_address}}</p>
                        </div>
                   
                    {%else%}
                    <p></p>
                    {%endif%}
                    </th>
                    
                    <th>
                        <div class="text-muted">
                            <h5 class="font-size-15 mb-1" style="line-height: 0.7;">Port of Loading</h5>
                            <p class="mb-1" style="line-height: 1.2;font-size: small;">{{my_order.port_of_loading}}</p>

                        </div>
                        <div class="text-muted">
                            <h5 class="font-size-15 mb-1" style="line-height: 0.7;">Port Of Discharge</h5>
                            <p class="mb-1" style="line-height: 1.2;font-size: small;">{{my_order.port_of_discharge}}</p>

                        </div>

                        <div class="text-muted">
                            <h5 class="text-muted text-sm-end font-size-15 mb-1" style="line-height: 0.7;">Means of
                                Transport</h5>
                            <!-- <p class="mb-1">Bole Sub city, Kebele 02,House No. 393/2</p> -->
                            <p class="mb-1" style="font-size: small;line-height: 1.2;">{{my_order.transportation}}</p>
                        </div>
                    </th>
                    <th>
                        <div class="text-muted">
                            <h5 class="text-muted text-sm-end font-size-15 mb-1" style="line-height: 0.7;"> Country of Origin</h5>
                            <!-- <p class="mb-1">Bole Sub city, Kebele 02,House No. 393/2</p> -->
                            <p class="mb-1" style="font-size: small;line-height: 1.2;">{{my_order.country_of_origin}}</p>
                        </div>
                        <div class="text-muted">
                            <h5 class="text-muted text-sm-end font-size-15 mb-1" style="line-height: 0.7;"> Final Destination</h5>
                            <!-- <p class="mb-1">Bole Sub city, Kebele 02,House No. 393/2</p> -->
                            <p class="mb-1" style="font-size: small;line-height: 1.2;">{{my_order.final_destination}}</p>
                        </div>
                        <div class="text-muted">
                            <h5 class="font-size-15 mb-1" style="line-height: 0.7;">Payment Terms</h5>
                            <p class="mb-1" style="line-height: 1.2;font-size: small;">{{my_order.payment_type}}</p>

                        </div>
                        
                        <div class="text-muted">
                            <h5 class="text-muted text-sm-end font-size-15 mb-1" style="line-height: 0.7;"> Shipment Terms</h5>
                            <!-- <p class="mb-1">Bole Sub city, Kebele 02,House No. 393/2</p> -->
                            <p class="mb-1" style="font-size: small;line-height: 1.2;">{{my_order.shipment_type}}</p>
                        </div>
                    </th>


                    {% if my_order.freight_amount %}

                    <th scope="row" colspan="4" class="border-0 text-end">
                        Shipping Charge :</th>

                    <td class="border-0 text-end">
                        <p id="shipping_price">${{my_order.freight_amount}}</p>
                    </td>


<!-- end tr -->
                <tr>
                    <th scope="row" colspan="4" class="text-end">Sub Total</th>
                    <td class="text-end" id="total_price">${{my_order.PR_total_price|add:my_order.freight_amount }}</td>
                </tr>

                {% else %}

                {% endif %}


                </tr>
                <!-- end tr -->
            </tbody><!-- end tbody -->
        </table><!-- end table -->
    </div>
    <!-- end row -->

    <div class="py-2" style="margin: 0;">
        <h5 class="font-size-15">Order Summary</h5>

        <div class="table-responsive">
            <table class="table align-middle table-nowrap table-centered mb-0" style="margin: 0; padding: 0;border-collapse: collapse;
            border-spacing: 0;">
                <thead>
                    <tr>
                        <th style="width: 70px;">No.</th>
                        <th>Item</th>
                        <th>Price in USD</th>
                        <th>Quantity</th>
                        <th>Unit of Measurement</th>
                        <th class="text-end" style="width: 120px;">Total</th>
                    </tr>
                </thead><!-- end thead -->
                <tbody>


                    {% if pr_items %}
                    {% for delivery in pr_items %}
                    <tr>
                        <td style="font-weight: bold;">0{{ forloop.counter }}</td>
                        <td>
                            <div>
                                <h5 class="text-truncate font-size-14 mb-1">{{delivery.item_name}} {{delivery.description}}</h5>
                                <p class="text-muted mb-0">HS-code:{{delivery.hs_code}}</p>
                            </div>
                        </td>
                        {% if my_order.country %}
                        <td> ${{delivery.price}}</td>
                        <td>{{delivery.quantity}}</td>
                        <td> {{delivery.measurement}} </td>
                        <td> ${{delivery.total_price}} </td>
                        {% else %}
                        <td> ${{delivery.price}}</td>
                        <td>{{delivery.quantity}}</td>
                        <td> {{delivery.measurement}} </td>
                        <td> ${{delivery.before_vat}} </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    {% endif %}
                    
                    {% if my_order.insurance and my_order.freight_price %}


                    {% comment %} {% if %} {% endcomment %}
                    <tr>
                        <th scope="row" colspan="4" class="border-0 text-end" style="margin: 0;padding: 0;">
                            Freight :</th>

                        <td class="border-0 text-end" style="margin: 0;padding: 0;">
                            <p id="shipping_price" style="color: black;">${{my_order.freight_price}}</p>
                        </td>
                    </tr>


                    <tr>
                        <th scope="row" colspan="4" class="border-0 text-end" style="margin: 0;padding: 0;">
                            Insurance :</th>

                        <td class="border-0 text-end" style="margin: 0;padding: 0;">
                            <p id="shipping_price" style="color: black;">${{my_order.insurance}}</p>
                        </td>
                    </tr>

                    <!-- end tr -->

                    <tr style="margin: 0;line-height: 1;padding: 0;">
                        <th scope="row" colspan="1" class="text-end" style="margin: 0;line-height: 1;padding: 0;">Total
                        </th>
                        <td colspan="3" style="margin: 0;padding: 0;">Amount in Words: USD {{num}} </td>
                        <td class="text-end" id="total_price" style="margin: 0;padding: 0;">
                            ${{number|intcomma }}</td>
                    </tr>

                    {% comment %} {% endif %} {% endcomment %}

                    {% elif my_order.freight_price %}
                    <tr>
                        <th scope="row" colspan="4" class="border-0 text-end" style="margin: 0;padding: 0;">
                            Freight :</th>

                        <td class="border-0 text-end" style="margin: 0;padding: 0;">
                            <p id="shipping_price" style="color: black;">${{my_order.freight_price}}</p>
                        </td>
                    </tr>

                    <!-- end tr -->

                    <tr style="margin: 0;line-height: 1;padding: 0;">
                        <th scope="row" colspan="1" class="text-end" style="margin: 0;line-height: 1;padding: 0;">Total
                        </th>
                        <td colspan="3" style="margin: 0;padding: 0;">Amount in Words: USD {{num}} </td>
                        <td class="text-end" id="total_price" style="margin: 0;padding: 0;">
                            ${{number|intcomma }}</td>
                    </tr>


                    {% else %}

                    <!-- end tr -->
                    <tr style="margin: 0;line-height: 1;padding: 0;">
                        <th scope="row" colspan="1" class="text-end" style="margin: 0;line-height: 1;padding: 0;">Total
                        </th>
                        <td colspan="3" >Amount in Words: USD {{num}} </td>
                        {% if my_order.order_no %}
                        <td class="text-end" id="total_price">
                            ${{my_order.PR_before_vat|intcomma }}</td>
                        {%else%}
                        <td class="text-end" id="total_price">${{my_order.before_vat|intcomma }}</td>
                        {%endif%}
                    </tr>
                    {% endif %}

                    </tr>
                    <!-- end tr -->
                </tbody><!-- end tbody -->
            </table><!-- end table -->
        </div><!-- end table responsive -->
    </div>
 
        {%if my_order.order_no %}
        <div style="display: flex;"> 
            <div style="flex: 2; margin-top: 40px; margin-left: 20px">
                <h4>Payment must be remitted to: </h4>
                <p class="text-muted"> Beneficiary: Cosmic Connection FZE </br> 
                Beneficiary Bank details:</br> 
                BANK NAME: EXIM BANK</br> 
                BANK ADDRESS: EXIM HOUSE - 13, PLACE</br> 
                LAGARDE - P.0.BOX 4455, DJIBOUTI </br> 
                SWIFT: EXTNDJJD </br> 
                Account Number: 0040000193 </br> 
                IBAN no: 000120000040000193 </br>
                </p>
            
            </div>
    
            <div style="flex: 1; margin-top: 40px;">
            <h4>Conditions</h4>
            <p class="text-muted">1. Partial Shipment <br> to be allowed <br>
               2. Transshipment <br> to be allowed <br>
            </p>
            
            </div> 
    
            <div style="flex: 1;"> 
                <img  alt="" src="/static/stamp.jpg" height="154px" width="154px" style="margin-top: 30px;"> <br>
                <img  alt="" src="/static/sign.jpg" height="44px" width="134px">
            </div>
          </div> 
       
    </div>
        {%else%}
        <div style="float: right;"> 
            <img  alt="" src="../../static/stamp.jpg" height="154px" width="154px" style="margin-top: 10px;"> <br>
            <img  alt="" src="/static/sign.jpg" height="44px" width="134px">
        </div>
        {%endif%}
   
       
</div>
    
       
   


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"
    integrity="sha384-eMNCOe7tC1doHpGoWe/6oMVemdAVTMs2xqW4mwXrXsW0L84Iytr2wi5v2QjrP/xp"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js"
    integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/"
    crossorigin="anonymous"></script>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            const totalPrice = document.getElementById('total_price')
            const shippingPriceElement = document.getElementById('shipping_price');
            
    
            var total_price = parseFloat(totalPrice.textContent);
            var shippingPrice = parseFloat(shippingPriceElement.textContent);
            console.log(shippingPrice)
            shippingPrice = shippingPrice.toString()
            var modifiedValue = shippingPrice.replace('$', '');
            console.log(modifiedValue)
            
    
            
    
        })
    
    </script>

{% endblock %}
